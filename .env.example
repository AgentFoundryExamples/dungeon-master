# Dungeon Master Service Configuration
# Copy this file to .env and fill in your actual values

# ============================================================================
# JOURNEY-LOG SERVICE CONFIGURATION
# ============================================================================

# Base URL for the journey-log service (required)
# Examples: http://localhost:8000, https://journey-log-abcd123-uc.a.run.app
JOURNEY_LOG_BASE_URL=http://localhost:8000

# HTTP timeout for journey-log requests in seconds (default: 30)
# Range: 1-300 seconds
JOURNEY_LOG_TIMEOUT=30


# ============================================================================
# OPENAI API CONFIGURATION
# ============================================================================

# OpenAI API key for LLM requests (required)
# Get your key from: https://platform.openai.com/api-keys
# IMPORTANT: Never commit this value to source control
OPENAI_API_KEY=sk-your-openai-api-key-here

# OpenAI model to use for narrative generation (default: gpt-5.1)
# For GPT-5+ models, use gpt-5.1 or later (see infrastructure_versions.txt)
# Examples: gpt-4, gpt-5.1, gpt-4-turbo-preview
OPENAI_MODEL=gpt-5.1

# HTTP timeout for OpenAI requests in seconds (default: 60)
# Range: 1-600 seconds
# Note: LLM generation can take time, set appropriately
OPENAI_TIMEOUT=60

# Enable stub mode for offline development (default: false)
# When true, LLM client returns stub responses without calling OpenAI API
# Useful for testing and development without API costs
OPENAI_STUB_MODE=false


# ============================================================================
# JOURNEY-LOG CLIENT CONFIGURATION
# ============================================================================

# Default number of recent narrative turns to fetch (default: 20)
# Range: 1-100
# This controls how much recent history is sent to the LLM for context
JOURNEY_LOG_RECENT_N=20


# ============================================================================
# HEALTH CHECK CONFIGURATION
# ============================================================================

# Whether to ping journey-log service during health checks (default: false)
# Set to true to enable health endpoint to check journey-log accessibility
# Note: Health checks use a short 5-second timeout
HEALTH_CHECK_JOURNEY_LOG=false


# ============================================================================
# SERVICE CONFIGURATION
# ============================================================================

# Service name for logging and identification (default: dungeon-master)
SERVICE_NAME=dungeon-master

# Logging level (default: INFO)
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Enable JSON structured logging output (default: false)
# Set to true for easier parsing by log aggregation tools (e.g., CloudWatch)
LOG_JSON_FORMAT=false


# ============================================================================
# METRICS CONFIGURATION
# ============================================================================

# Enable metrics collection and /metrics endpoint (default: false)
# When enabled, service collects metrics on requests, errors, and latencies
ENABLE_METRICS=false


# ============================================================================
# DEBUG CONFIGURATION
# ============================================================================

# Enable debug endpoints like /debug/parse_llm (default: false)
# WARNING: Only enable for local development. Do NOT enable in production.
# Debug endpoints expose internal parsing logic and should be protected.
ENABLE_DEBUG_ENDPOINTS=false


# ============================================================================
# POLICY ENGINE CONFIGURATION
# ============================================================================

# Quest trigger probability (default: 0.3)
# Range: 0.0-1.0
# Controls the likelihood of quest triggers per turn
QUEST_TRIGGER_PROB=0.3

# Quest cooldown turns (default: 5)
# Minimum: 0 (zero or negative values skip waiting periods)
# Number of turns that must pass between quest triggers
QUEST_COOLDOWN_TURNS=5

# POI trigger probability (default: 0.2)
# Range: 0.0-1.0
# Controls the likelihood of POI (Point of Interest) triggers per turn
POI_TRIGGER_PROB=0.2

# POI cooldown turns (default: 3)
# Minimum: 0 (zero or negative values skip waiting periods)
# Number of turns that must pass between POI triggers
POI_COOLDOWN_TURNS=3

# RNG seed for deterministic debugging (default: unset)
# When unset, uses secure randomness (recommended for production)
# When set to an integer, enables reproducible random behavior for testing
# This is useful for:
# - Debugging policy decision logic
# - Writing deterministic integration tests
# - Reproducing specific gameplay scenarios
# Example: RNG_SEED=12345
# Note: Each character gets their own RNG sequence derived from this seed
# RNG_SEED=


# ============================================================================
# POLICY ENGINE DEBUG PROFILES
# ============================================================================

# The policy engine supports various profiles for different testing scenarios.
# Uncomment one of the profiles below to test specific behaviors:

# --- High Frequency Profile ---
# For testing frequent quest and POI triggers
# QUEST_TRIGGER_PROB=0.9
# QUEST_COOLDOWN_TURNS=1
# POI_TRIGGER_PROB=0.8
# POI_COOLDOWN_TURNS=1
# RNG_SEED=42

# --- Low Frequency Profile ---
# For testing rare triggers and long cooldowns
# QUEST_TRIGGER_PROB=0.1
# QUEST_COOLDOWN_TURNS=10
# POI_TRIGGER_PROB=0.1
# POI_COOLDOWN_TURNS=10
# RNG_SEED=42

# --- Deterministic Testing Profile ---
# For testing with predictable outcomes
# QUEST_TRIGGER_PROB=1.0
# QUEST_COOLDOWN_TURNS=0
# POI_TRIGGER_PROB=1.0
# POI_COOLDOWN_TURNS=0
# RNG_SEED=999

# --- Disabled Profile ---
# For testing with triggers completely disabled
# QUEST_TRIGGER_PROB=0.0
# QUEST_COOLDOWN_TURNS=999
# POI_TRIGGER_PROB=0.0
# POI_COOLDOWN_TURNS=999
# RNG_SEED=0
